SHELL=/bin/sh
MAILDIR=$HOME/Maildir/
DEFAULT=$MAILDIR
LOGFILE=$HOME/.pmlog
LOGABSTRACT="all"
VERBOSE="on"

# Backups while I'm messing with .procmailrc
#:0 hc:
#/users/home/mledbetter/Backup/mbox-procmailtest-3


# Condition scoring
# (mostly taken from <http://perlcode.org/tutorials/procmail/proctut/proctip2.pod> )
# See my section on trash mail for examples on how to use this value, but it's
# designed to facilitate "OR" matching - if a message matches any or all of some
# list of conditions. 
SPR=2147483647

### Random stupid things not to forget:
# 1 close your freaking folders with a "/". it's ".lists.sunhelp-geeks/"
# 2 start with a "*", don't just begin your rule. that is bad bad bad. 
# 3 the "+" must be escaped with a "\", as must all "." characters. 
# 4 don't put comments on the end of lines. a line like 
#       * $ $SPR^0 ^Subject:.*cows   # this matches "cows"
#   will be evaluated much differently than you think.

:0:
#* ^Delivered-To:.*mledbetter\@neuric\.com.*
* ^X-Original-To:.*micah\+neuric\@micahrl\.com.*
.Neuric/

# Trash mail - I don't ever want to see this shit
# Use this as my example of condition scoring... matching ANY of these
# conditions is enough to dump the mail to /dev/null
:0:
* $ $SPR^0 ^To:.*vlack\+spam
* $ $SPR^0 ^To:.*vlack\+temp
* $ $SPR^0 ^From:.*Vanessa.*Smith
* $ $SPR^0 ^To:.*vlack\+f\.retailreportcard
* $ $SPR^0 .*vlack\+f\.retailreportcard
* $ $SPR^0 .*retailreportcard.*
* $ $SPR^0 ^X-Original-To:.*offers 
* $ $SPR^0 ^To:.*vlack\@howe\.textdrive\.com
* $ $SPR^0 ^To:.*vlack.*marin\.joyent\.us
* $ $SPR^0 ^To:.*mledbetter\@marin\.joyent\.us
/dev/null

# MAILMAN REMINDERS
# to quote young Jeffrey:
# "I'm so completely not interested in receiving these at the end of every month"
#:0:
#* ^From: .*mailman-owner@
#* ^Subject: .* mailing list memberships reminder
#/dev/null

# Capstone
:0
* ^X-Original-To: .*vlack\+capstone\@vlack\.com
.Capstone/

# Facebook agh so many messages
:0
* $ $SPR^0 ^From: .*facebookmail\.com
* $ $SPR^0 ^From: .*postmaster\.twitter\.com
.Facebook/


# Evernote: Email here to file stuff directly into Evernote
:0
* ^X-Original-To: .*vlack\+evernote@vlack\.com
! mrled.82214@m.evernote.com  


### my lists stuff. based on 
    ## Jamie Wilkinson's http://spacepants.org/dot.procmailrc
    ## and more that I don't have mentioned here mmmk

# Commented so that ALL email gets this processing
# I hope this doesn't break anything, and it lets me migrate to 
# no vlack-lists in the future (which will be awesome).

#:0
#* ^Delivered-To:.*vlack-lists-vlack\.com
#{
    
    
    ## I want to rename these lists
    
    # ooh, here's a cool way to do this
    # from http://www.opensubscriber.com/message/euglug@euglug.org/2802827.html
    
    # sunhelp
    :0  
    * ^List-Id:.*<[-A-Za-z0-9]*\.sunhelp\.org>  
    * ^List-Id:.*<\/[-A-Za-z0-9]*  
    .lists.sunhelp-${MATCH}/  
    # sgihelp - changed from @sgihelp.org to @lists.synack-hosting.com
    :0  
    * ^List-Id:.*<[-A-Za-z0-9]*\.lists\.synack-hosting\.com>  
    * ^List-Id:.*<\/[-A-Za-z0-9]*  
    .lists.sgihelp-${MATCH}/  

    ## statically-defined lists
    
    :0
    * ^Sender:.*college-owner\@oiketes.hopeoffice.org
    .lists.hsl-college/
    :0
    * ^Sender:.*MACENTERPRISE\@lists\.psu\.edu
    .lists.macenterprise/
    :0
    * ^List-ID: alt\.sysadmin\.recovery\.googlegroups\.com
    .lists.asr/

    
    ## announce lists can all go in the same place as far as I'm concerned
    :0 
    * $ $SPR^0 ^List-Id:.*announce.*
    * $ $SPR^0 ^List-Id:.*freeverse.*
    * $ $SPR^0 ^List-Id:.*ambrosia.*
    * $ $SPR^0 ^Sender:.*owner.*announce.*
    * $ $SPR^0 ^Sender:.*announce.*owner.*
    * $ $SPR^0 ^List-Id:.*gentoo-gwn\.gentoo\.org
    * $ $SPR^0 ^List-Id:.*fvpr\.fridge\.net 
    * $ $SPR^0 ^List-Id:.*security-announce\.lists\.apple\.com
    * $ $SPR^0 ^List-Id:.*spokengroove.*
    * $ $SPR^0 ^Subject:.*testingannouncerule.*
    * $ $SPR^0 ^To:.*lemswap\@googlegroups\.com
    * $ $SPR^0 ^List-Id:.*Improv\*Everywhere
    .lists.announce/
    
    ## bring on the automatic list filtering. long time in coming.
    
    # generic ezmlm filter, comes before mailman otherwise mailman's filter
    # will put everything into .list.contact/
    :0
    * ^Mailing-list: contact .*; run by ezmlm
    * ^List-Post: [<]mailto:\/.*
    {
        LISTID=$MATCH
        
        :0
        * LISTID ?? ^ *\/[^@]*
        {
            LIST=$MATCH
            
            :0
            * LISTID ?? ^.*@\/[^>\.]*
            .lists.$MATCH-$LIST/
        }
    }
    
    # onelist/egroups/yahoogroups/whatever_they're_called_today
    # lists with their non-standard header format, and ad nuker
    :0
    * ^Mailing-List: list \/[^@]+
    {
        LISTID=$MATCH
        
        :0 fbw
        | sed '/-\~-->$/,/--\~->$/d'    
        
        :0
        .lists.$LISTID/
    }
    
    # Automagically handle nice standards conformant mailing lists - this
    # rule and the majordomo recipe appear courtesy of Jeff Waugh Records
    :0
    * ^(List-Id|(X-)?Mailing-List|X-List):\/.*
    {
        LISTID=$MATCH
        
        :0
        * LISTID ?? ^.*[<]\/[^@>\.]*
        .lists.$MATCH/
        
        :0
        * LISTID ?? ^\/[^@\.]*
        .lists.$MATCH/
    }
    
    # majordomo lists
    :0
    * ^Sender: owner-[^@]+@[^@]+
    * ^Sender: owner-\/[^@]+
    .lists.$MATCH/
    
    # if none of these match, it should go into the lists dir
#    :0
#    .lists/
#}

### The rest of the email will be delivered into my default mailbox,
### so no more rules are necessary