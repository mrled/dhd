# Micah's .mrconfig -*- mode: shell-script; -*-
# There is woefully not really any documentation on .mrconfig
# You pretty much have to use mrconfig.complex in mr.git

# Do NOT put blank lines after equals signs: 
# lib = 
#   asdf() {
#   
#       ls /usr/local/src
#   }
# this fails weirdly! No spaces, but comments are OK. (!?)

[DEFAULT]
# include all available libs
include = cat ~/opt/src/mr/lib/* 2>/dev/null || true

lib = 
    linkme() {
        for file in "$@"; do
            test -r "$file" && ln -sf "$file" "~/"
        done
    }
    linkdhd() { 
        for file in "$@"; do
            linkme "~/doc/dhd/hbase/$file"
        done
    }
    linkuenc() { 
        for file in "$@"; do 
            linkme "~/doc/uenc/hbase/$file"
        done
    }
    # on() checks whether the host I'm on is included in the cli-specified
    # values. A value can also have a username in it, ie "joey@dodo".
    # This is just used to simplify the functions below like trusted()
	on() {
		for host in $@; do
			if [ "${host%@*}" != "${host#*@}" ]; then
				if [ "$whoami" != "${host%@*}" ]; then
					continue
				fi
				host="${host#*@}"
			fi
			if [ "$hostname" = "$host" ]; then
				return 0
			fi
		done
		return 1
	}
    trusted() {
        on mrled@andraia mrled@lola mrled@tika mrled@parker mrled@goldmoon
    }
    wantgui() {
        on mrled@andraia mrled@parker
    }
    
## Public repositories 
[doc/dhd]
order = 1
checkout =
	if trusted; then
        svn co svn+ssh://mrled@tika.mrled.org/home/mrled/repo/dhd
	else
		svn co http://tika.mrled.org/svn/dhd
	fi

## Private repositories
[doc/uenc]
checkout = git clone mrled@mrled.org:~/opt/repo/uenc.git 
skip = ! trusted
[doc/code]
checkout = git clone mrled@mrled.org:~/opt/repo/code.git 
skip = ! trusted
[doc/privateweb]
checkout = git clone mrled@mrled.org:~/opt/repo/privateweb.git 
skip = ! trusted

## Work repositories
[doc/neuric]
checkout = svn co svn+ssh://mrled@mrled.org/home/mrled/svn/neuric
skip = ! trusted
[doc/tucpa]
checkout = svn co svn+ssh://mrled@mrled.org/home/mrled/svn/tucpa
skip = ! trusted

## Third party repositories that I track e.g. for projects
[opt/src/mr]
checkout = git clone git://git.kitenet.net/mr 
#checkout = 
#    git clone git://git.kitenet.net/mr && 
#    cp ~/opt/src/mr/mr ~/doc/dhd/local/bin/
#? update = git pull && cp ~/opt/src/mr/mr ~/doc/dhd/local/bin/
push = error "This does not belong to you."

[opt/src/conkeror]
checkout = git clone git://repo.or.cz/conkeror.git
push = error "This does not belong to you."
skip = ! wantgui

[opt/src/emacs]
checkout = cvs -d ':pserver:anonymous@cvs.savannah.gnu.org:/cvsroot/emacs' co -d emacs
skip = ! on mrled@andraia


#[]
#checkout = 
#    linkdhd  .screenrc .mrconfig .emacs .tcshrc .dir_colors &&
#    linkuenc .netrc 
#update = echo ""
